# AWS Cost Estimate (月額概算)

本ドキュメントでは、LLM GM ソロTRPGの稼働に伴うAWS利用料金の概算を算出しています。

## 💸 結論
個人利用（月間約30時間プレイ）の範囲であれば、**ほぼ全額がAWSの無料枠内に収まる**か、請求されても**月額数十円〜数百円程度**と推測されます。
*(※ただし、Phase Dで導入予定の Amazon Bedrock (LLM) の利用料は別途トークン課金となります)*

---

## 📊 前提条件
- プレイヤー: 1名（開発者本人のみ）
- プレイ頻度: 毎日1時間（月間30時間）
- 1セッション: 約10ターン（リクエスト）
- 1ターンのデータ転送量: リクエスト数KB / レスポンス数KB 以下

---

## 🛠 各AWSリソースの概算

### 1. Amazon S3 (フロントエンド静的ホスティング)
- **用途:** React (Vite) によりビルドされたファイル (HTML, CSS, JS) の保存。
- **データ量:** 最大でも数MB程度。
- **コスト概算:** 5GBまでは無料枠（12ヶ月）+ S3標準のストレージ料金は 0.025 USD/GB。数MBなら実質 **0円/月**。

### 2. Amazon CloudFront (CDN)
- **用途:** S3バケットからのコンテンツ配信、HTTPS(SSL)対応、キャッシュ機能。
- **データ転送量:** 月間数十MB程度。
- **コスト概算:** 毎月 1TBのデータ転送アウトは無料。余裕で無料枠内のため **0円/月**。

### 3. Amazon API Gateway (HTTP API)
- **用途:** フロントエンドからLambdaへのリクエスト受け付け (`POST /api/chat`)。
- **リクエスト数:** 1日30リクエスト想定 × 30日 = 月間 900リクエスト。
- **コスト概算:** 最初の3億リクエストまでは 1.00 USD/100万リクエスト（REST API の場合。HTTP APIならもっと安い）。900リクエストは実質 **0円/月**。

### 4. AWS Lambda (バックエンド計算処理)
- **用途:** API Gatewayからのリクエストを受け取り、ステート情報の処理とLLM通信を担う。
- **リソース:** メモリ 256MB または 512MB 設定。
- **実行回数:** 月間 900回。
- **実行時間:** 1回あたり数秒想定（Bedrockのレスポンス待ち時間含む）。
- **コスト概算:** 1ヶ月あたり100万件のリクエスト、40万GB秒のコンピューティングタイム無料（永続無料枠）。月間数千秒なら完全に無料枠内のため **0円/月**。

### 5. Amazon CloudWatch Logs
- **用途:** Lambdaの実行ログとエラーログの保存。
- **データ量:** 数MB程度。
- **コスト概算:** 毎月 5GBのログ保存までは無料。これも実質 **0円/月**。

### 6. Amazon Bedrock (LLM推論API)
- **用途:** ゲーム内の全シナリオ生成およびテキスト処理を担う（Claude 3 Haiku利用）。
- **モデル:** `anthropic.claude-3-haiku-20240307-v1:0`
- **リクエスト数とトークン概算:**
  - 1セッション(約10ターン)あたり合計 入力 約15,000トークン / 出力 約3,000トークン と仮定
  - 1日1セッション × 30日 = 月間 約450,000 入力トークン / 90,000 出力トークン
- **単価 (東京地域概算):**
  - 入力: $0.25 / 1000トークン ※Haikuの想定単価 (変動あり、$0.00025/1kかも)
  - （※実際には Claude 3 Haiku の料金は入力 $0.25/1M tokens, 出力 $1.25/1M tokens 程度と非常に安価です）
- **コスト概算:**
  - 450,000入力 = 0.45 * 0.25 = $0.11
  - 90,000出力 = 0.09 * 1.25 = $0.11
  - 合計: 月額 **約 $0.22 (約30円〜40円)** 程度。
  
> **⚠️ 注意:** APIキーの流出や、意図せぬ無限・過剰リクエストループのバグ等による意図しない請求を防ぐため、AWS Billingでのアラート設定（予算アラート：例 10 USD 等）を強く推奨します。
